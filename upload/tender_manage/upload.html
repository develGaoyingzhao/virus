<!DOCTYPE html>
<html lang="en">
   <head>
       <meta charset="UTF-8">
       <meta name="renderer" content="webkit"/>
       <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <title>Title</title>
    <style>
        *{padding:0;margin:0}
        body{font-family: Microsoft yahei;}
        .file{display:inline-block; width:128px; height:32px;line-height:32px; background:#f5f5f5; position:relative; overflow:hidden;font-size:14px;border:1px solid #aaa;text-align:center;}
        .file input{position:absolute; right:0; top:0; font-size:100px; opacity:0; filter:alpha(opacity=0);}
        input{font-family: Microsoft yahei;}
    </style>
    </head>
    <body>
    <form action="" id="form" method="post" enctype=multipart/form-data>
        <span class="file"><input type="file" onChange='upload();' id="file" name="file" value=""/>选择文件</span>
    </form>
    <script src="js/jquery-1.8.1.min.js"></script>
    <script src="js/common.js"></script>
    <script>

        console.log(GetQueryString("url"));
        console.log(GetQueryString("flag"));
        console.log(GetQueryString("token"));


        var flag=GetQueryString("flag");
        var token=GetQueryString("token");

        document.getElementById("form").action=serverUrl+"uploader?flag="+flag+"&token="+token;

        parent.uploadImg(GetQueryString("url"),GetQueryString("flag"));

        function upload()
        {
            var filename=$("#file").val();
            var index1=filename.lastIndexOf(".");
            var index2=filename.length;
            var postf=filename.substring(index1,index2).toLowerCase();//后缀名

            if(postf!=".jpg"&&postf!=".jpeg"&&postf!=".bmp"&&postf!=".gif"&&postf!=".png")
            {
                alert("抱歉，您上传的文件是不允许的扩展名。只允许jpg .jpeg .bmp .gif .png格式。");
            }
            else {
                document.getElementById("form").submit();
            }
        }



    </script>
    </body>

</html>